---
title: "Project4"
name: Camille Cavicchio, Jared Steinberg, and Alain Perez
output: html_document
---

```{r, message=FALSE, echo=FALSE, warning=FALSE}
library(dbplyr)
library(mdsr)
library(RMySQL)
library(ggthemes)
library(sf)
```

```{r, message=FALSE, echo=FALSE, warning=FALSE}
db<-dbConnect_scidb("fec")
```

```{r, message=FALSE, echo=FALSE, warning=FALSE, eval=FALSE}
dbListTables(db)
```


```{sql connection= db}
SELECT
  c.cand_id,
  c.cand_name,
  c.cand_party_affiliation,
  c.cand_election_yr,
  c.cand_office_state,
  b.transaction_dt, 
  sum(transaction_amt) AS total_trans
FROM candidates AS c 
LEFT JOIN contrib_com_to_cand AS b ON c.cand_id = b.cand_id 
WHERE c.cand_election_yr >= 2016 AND c.cand_id<=1 AND b.transaction_dt<=1
GROUP BY c.cand_id
order by c.cand_office_state
```

```{r, message=FALSE, echo=FALSE, warning=FALSE}
fec<-"SELECT
  c.cand_id,
  c.cand_name,
  c.cand_party_affiliation,
  c.cand_election_yr,
  c.cand_office_state,
  b.transaction_dt, 
  sum(transaction_amt) AS total_trans
FROM candidates AS c 
LEFT JOIN contrib_com_to_cand AS b ON c.cand_id = b.cand_id 
WHERE c.cand_election_yr >= 2016 AND c.cand_id<=1 AND b.transaction_dt<=1
GROUP BY c.cand_id
order by c.cand_office_state"
```

<<<<<<< HEAD

=======
>>>>>>> 4dcb902e5abfdc12e7a5e0eb521e2e5e4efccaec
```{r, message=FALSE, echo=FALSE, warning=FALSE}
fecinfo<-db%>% dbGetQuery(fec) %>% collect()
fecinfo
```

```{r, message=FALSE, echo=FALSE, warning=FALSE}
<<<<<<< HEAD

=======
pop<-read.csv("statespopulation.csv")
pop <- pop %>%
  select(State, X2016) %>%
  rename(pop = "X2016") %>%
  mutate(pop = parse_number(pop))
pop

```

```{r}
>>>>>>> 4dcb902e5abfdc12e7a5e0eb521e2e5e4efccaec
fecinfo <- fecinfo %>%rename(State = 'cand_office_state',
                             ID='cand_id',
                             name='cand_name',
                             party='cand_party_affiliation',
                             year= 'cand_election_yr',
                             transactions='total_trans') %>%
  select(-transaction_dt)
fecinfo
```


```{r}
fecinfo <- fecinfo %>%
  left_join(pop, by = "State")

fecinfo

pop<-read.csv("statespopulation.csv")
View(pop)


```



